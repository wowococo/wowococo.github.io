---
title: 进程间的通信方式
excerpt: 进程间的用户空间是各自独立的，那么进程是如何通信的呢？
date: 2021-05-18 11:03:25
tags: 进程 操作系统
---
## 进程间的通信
进程间的用户空间是各自独立，不共享的，但是可以通过内核空间来实现通信。比如，管道、消息队列、共享内存、信号量、信号、socket, 这几种方式逐一递进，下一级解决了上一个的一些不足。前五种都是在同一台主机上的进程间的通信，最后一个 socket 可以实现跨主机跨网络的进程通信。

### 管道
管道是内核里面的一串缓存。

有匿名管道和命名管道。Linux里的管道符 | 就是匿名管道，对于匿名管道，它的通信范围是存在父子关系的进程，对于命名管道，它的通信范围可以是没有关系的进程。

优点：简单

缺点：一个命令向 管道里写入数据之后只有被其他命令读取后才可以正常退出，这种方式对于频繁的进程操作不友好。

### 消息队列
消息队列是内核中的消息链表。

一个进程把消息放在消息队列里，就可以退出了。另一个进程什么时候需要就什么时候去读。就像双方发邮件一样。

优点: 可以解决上面管道存在的问题，一个发数据的进程不用等待另一个进程退出才能退出。

缺点：通信不及时，就像邮件的附件一样，它不能过大，所以它不能传输大数据量，通信过程中存在用户态和内核态之间的数据拷贝开销。

## 共享内存
上面提到的消息队列中存在用户态和内核态之间的数据拷贝开销，而使用共享内存可以解决这个问题。共享内存是指两个进程各自用自己的一块虚拟内存去共享同一块物理内存。一个进程修改了共享内存，另一个进程马上就能感知到。

优点：能够避免用户态和内核态之间的数据拷贝开销，提高通信效率。

缺点：如果有多个进程一起修改共享内存，会造成冲突，有可能这个进程修改的部分被其他进程所做的修改覆盖。

### 信号量
信号量针对共享内存存在的多进程同时修改造成冲突的问题所提出的一种解决方法。
P: 在执行进程前，
V: 在执行进程后
